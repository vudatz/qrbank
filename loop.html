<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Tool Cày View - Auto Reload Custom</title>
    <style>
        body { background: #000; color: #fff; text-align: center; font-family: 'Segoe UI', sans-serif; }
        .config-box { background: #1a1a1a; padding: 20px; border-radius: 10px; margin-top: 20px; display: inline-block; width: 90%; border: 2px solid #ff0000; }
        textarea { width: 95%; height: 60px; background: #000; color: #0f0; border: 1px solid #444; padding: 10px; margin-bottom: 10px; }
        .controls { margin: 10px 0; }
        input[type="number"] { padding: 8px; background: #333; color: #fff; border: 1px solid #555; width: 70px; border-radius: 5px; text-align: center; }
        .btn-start { padding: 12px 35px; background: #ff0000; color: white; border: none; cursor: pointer; font-weight: bold; border-radius: 5px; text-transform: uppercase; }
        .btn-start:hover { background: #b30000; }
        #container { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 15px; padding: 20px; }
        iframe { width: 100%; height: 180px; border: 1px solid #333; border-radius: 5px; }
        .status-bar { color: #00ff00; font-family: monospace; margin-top: 10px; font-size: 1.2em; }
    </style>
</head>
<body>

<div class="config-box">
    <h2>YOUTUBE REFRESHER PRO</h2>
    <textarea id="embedCode" placeholder='Dán mã nhúng <iframe> vào đây...'></textarea>
    
    <div class="controls">
        <label>Số luồng: </label>
        <input type="number" id="threads" value="4" min="1">
        
        <label style="margin-left: 20px;">Reload sau (giây): </label>
        <input type="number" id="reloadTime" value="30" min="5">
    </div>
    
    <button class="btn-start" onclick="startBruteForce()">Kích Hoạt Ngay</button>
    <div class="status-bar" id="status">Sẵn sàng...</div>
</div>

<div id="container"></div>

<script>
    let timerObj = null;
    let countdownObj = null;

    function startBruteForce() {
        const rawCode = document.getElementById('embedCode').value;
        const count = document.getElementById('threads').value;
        const seconds = document.getElementById('reloadTime').value;
        const container = document.getElementById('container');
        const status = document.getElementById('status');

        if(!rawCode.includes('src="')) return alert("Mã nhúng không đúng rồi mày!");

        // Dừng các tiến trình cũ nếu có
        clearInterval(timerObj);
        clearInterval(countdownObj);

        // Hàm để load video
        const loadVideos = () => {
            container.innerHTML = "";
            let urlMatch = rawCode.match(/src="([^"]+)"/);
            if(!urlMatch) return;
            let baseSrc = urlMatch[1];
            
            // Thêm các tham số để tự chạy và tắt tiếng
            let separator = baseSrc.includes('?') ? '&' : '?';
            let finalUrl = baseSrc + separator + "autoplay=1&mute=1&t=" + Math.random();

            for(let i = 0; i < count; i++) {
                let currentIframe = rawCode.replace(/src="[^"]+"/, `src="${finalUrl}"`);
                const div = document.createElement('div');
                div.innerHTML = currentIframe;
                const ifr = div.querySelector('iframe');
                if(ifr) {
                    ifr.style.width = "100%";
                    ifr.style.height = "180px";
                }
                container.appendChild(div);
            }
            console.log("Đã reload tất cả luồng!");
        };

        // Chạy lần đầu
        loadVideos();

        // Thiết lập đếm ngược hiển thị cho vui mắt
        let timeLeft = seconds;
        countdownObj = setInterval(() => {
            timeLeft--;
            if(timeLeft <= 0) timeLeft = seconds;
            status.innerText = `Sẽ Reload sau: ${timeLeft}s...`;
        }, 1000);

        // Thiết lập vòng lặp reload
        timerObj = setInterval(() => {
            loadVideos();
        }, seconds * 1000);

        status.innerText = `Đang chạy ${count} luồng...`;
    }
</script>

</body>
</html>
